<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Group Allocation System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous" />
  <link rel="stylesheet" href="css/style.css" />
  <!-- jQuery used for file drag window (NICK) -->
  <script src="./js/jquery-3.6.1.min.js"></script>
  <!-- libraray  used to convert xlsx to array (Tanish)-->
  <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
  <!-- PapaParse used to convert CSV to array (NICK)-->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;900&family=Roboto:wght@300&display=swap"
    rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Encode+Sans+Condensed:wght@300&display=swap" rel="stylesheet" />
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/xlsx.full.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/jszip.js"></script>
  <script src="https://cdn.rawgit.com/abdennour/react-csv/6424b500/cdn/react-csv-latest.min.js"
    type="text/javascript"></script>
  <script lang="javascript" src="assets/downloads/xlsx.full.min.js"></script>
  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/amcharts/3.21.15/plugins/export/libs/FileSaver.js/FileSaver.min.js"></script>
</head>

<body>
  <!-- Design and creation of layout (HTML and CSS) (NICK) -->
  <header>
    <div class="logo">Team Allocation</div>
  </header>

  <div class="flex-container">
    <div id="flex-left">
      <div class="guide">
        <h3>Guide</h3>
        <ol>
          <li>Select a file to download from the 'download' tab bellow.</li>
          <li>
            Drag the file into the drag and drop box and press the corresponding button (i.e parse CSV for .csv file)
          </li>
          <li>
            The data will then be parsed and be available to download, select the output format you desire then the
            exported file will have allocated teams
          </li>
        </ol>
      </div>

      <!-- DATA DOWNLOADS FOR SUCCESSFUL PARSE (NICK) -->
      <div class="downloads">
        <h3>Downloads</h3>
        <button class="btn btn-primary" type="submit" onclick="window.open('assets/downloads/WRKTest-Data.csv')">
          Download Working .csv
        </button>
        <button class="btn btn-primary" type="submit" onclick="window.open('assets/downloads/WRKTest-Data.xlsx')">
          Download Working .xlsx
        </button>
      </div>
    </div>
    <div id="flex-right">
      <div class="container d-flex justify-content-center mt-100" style="background-color: #d9d9d9; padding-top: 50px">
        <div class="file-drop-area">
          <span class="choose-file-button">Choose files</span>
          <span class="file-message">or drag and drop files here</span>
          <input type="file" id="fileSelect" accept=".xlsx, .csv" class="file-input" />
        </div>
      </div>

      <div id="button-container">
        <button class="btn btn-primary" id="uploadConfirm">Submit</button>

        <!-- Adding extra buttons for the .csv file parser, .xlsx parser and a clear table button (MATT) -->
        <button class="btn btn-primary" id="btnUploadCsv">Read CSV</button>
        <button class="btn btn-primary" id="btnUploadXlsx" onclick="UploadProcess()">Read XLSX</button>
        <button class="btn btn-primary" id="clearTable">Clear Table</button>
      </div>

      <!-- creating maximum for the number of students to be allocated to a group (NICK) -->
      <div class="minMax">
        <label>Set Group Size:</label>
        <input id="size" type="text">
        <button class="btn btn-primary" onclick=basicAllocation()>Allocate</button>
      </div>
      <div class="d-flex justify-content-center">
        <button class="btn btn-primary" onclick="export2csv()">Export CSV</button>
        <button class="btn btn-primary" onclick="onXLSX()" id="button-a">Export Excel</button>
      </div>
    </div>
  </div>

  <!-- Table data is inside of the dataPaste div created by (NICK / MATT)-->
        <div class="dataPaste">
          <table id="tblData"></table>
        </div>
</body>

<script src="./js/main.js"></script>

</html>